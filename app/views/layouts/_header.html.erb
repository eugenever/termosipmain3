<!-- fixed navigation bar navbar-fixed-top -->
<div class="navbar navbar-inverse" role="navigation" id="nbheader">
  
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#b-menu-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">ТЕРМОСИП</a>
      <!-- <a class="navbar-brand" rel="home" href="#" title="ЛОР КЛИНИКА">
        <%= image_tag "logo.png", style: "max-height: 40px;" %>
      </a> -->

    </div>
    <div class="collapse navbar-collapse" id="b-menu-1">
      <ul class="nav navbar-nav navbar-right">

        <li class="<%= 'active' if current_page?(root_path) %>"><%= link_to "Главная", root_path %></li>
        <li class="<%= 'active' if current_page?(about_path) %>"><%= link_to "О компании", about_path %></li>
        <li class="<%= 'active' if current_page?(price_path) %>"><%= link_to "Прайс-лист", price_path %></li>
        <li class="<%= 'active' if current_page?(articles_path) %>"><%= link_to "Статьи", articles_path %></li>
        <li class="<%= 'active' if current_page?(object_path) %>"><%= link_to "Наши объекты", object_path %></li>
          
        <li id="fat-menu" class="dropdown <%= 'active' if current_page?(fotomaterial_path) || current_page?(videomaterial_path) %>">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Наши работы<b class="caret"></b>
          </a>
          <ul class="dropdown-menu">
            <li><%= link_to "Фотографии", fotomaterial_path %></li>
            <li class="divider"></li>
            <li><%= link_to "Видео", videomaterial_path %></li>
          </ul>
        </li>

        <li class="<%= 'active' if current_page?(contact_path) %>"><%= link_to "Контакты", contact_path %></li>
        <% if signed_in? %>
          <li><%= link_to "Users", users_path %></li>
          <li id="fat-menu" class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              Account <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
              <li><%= link_to "Profile", current_user %></li>
              <li><%= link_to "Settings", edit_user_path(current_user) %></li>
              <li class="divider"></li>
              <li>
                <%= link_to "Sign out", signout_path, method: "delete" %>
              </li>
            </ul>
          </li>
        <% else %>
          <li><%#= link_to "Sign in", signin_path %></li>
        <% end %>              

      </ul>
    </div> <!-- /.nav-collapse -->
  </div> <!-- /.container -->
  
</div> <!-- /.navbar -->
<!-- выпадающий список должен помещаться в рамках экрана -->
<script type="text/javascript">
  $('.dropdown-toggle').on("click", function() {
    var dropdownList = $('.dropdown-menu'),
    dropdownOffset = $(this).offset(),
    offsetLeft = dropdownOffset.left,
    dropdownWidth = dropdownList.width(),
    docWidth = $(window).width(),

    subDropdown = dropdownList.eq(1),
    subDropdownWidth = subDropdown.width(),

    isDropdownVisible = (offsetLeft + dropdownWidth <= docWidth),
    isSubDropdownVisible = (offsetLeft + dropdownWidth + subDropdownWidth <= docWidth);

    if (!isDropdownVisible || !isSubDropdownVisible) {
          dropdownList.css("right", "0").css("left", "auto");
    } else {
          dropdownList.css("right", "auto").css("left", "0");
    }
  });

  $('.dropdown-toggle').hover(function() {
    var dropdownList = $('.dropdown-menu'),
    dropdownOffset = $(this).offset(),
    offsetLeft = dropdownOffset.left,
    dropdownWidth = dropdownList.width(),
    docWidth = $(window).width(),

    subDropdown = dropdownList.eq(1),
    subDropdownWidth = subDropdown.width(),

    isDropdownVisible = (offsetLeft + dropdownWidth <= docWidth),
    isSubDropdownVisible = (offsetLeft + dropdownWidth + subDropdownWidth <= docWidth);

    if (!isDropdownVisible || !isSubDropdownVisible) {
          dropdownList.css("right", "0").css("left", "auto");
    } else {
          dropdownList.css("right", "auto").css("left", "0");
    }
  }, function() {
    // обработчик отведения мыши
  });

</script>